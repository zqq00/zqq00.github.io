window.__require=function t(r,a,e){function i(h,n){if(!a[h]){if(!r[h]){var o=h.split("/");if(o=o[o.length-1],!r[o]){var m="function"==typeof __require&&__require;if(!n&&m)return m(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+h+"'")}}var c=a[h]={exports:{}};r[h][0].call(c.exports,function(t){return i(r[h][1][t]||t)},c,c.exports,t,r,a,e)}return a[h].exports}for(var s="function"==typeof __require&&__require,h=0;h<e.length;h++)i(e[h]);return i}({game:[function(t,r,a){"use strict";cc._RF.push(r,"7961bcUObBLGZKQw3GSShY7","game"),cc.Class({extends:cc.Component,properties:{gameReady:cc.Node,gamePlay:cc.Node,gameOver:cc.Node,pre_itemBg:cc.Prefab,pre_item:cc.Prefab,itemParent:cc.Node,lab_num:cc.Label,lab_score:cc.Label,lab_bestScore:cc.Label,lab_scoreOver:cc.Label,lab_arrHistroy:cc.Label,sound_move:cc.AudioClip,sound_getScore:cc.AudioClip},onLoad:function(){cc.log("onLoad"),this.itemPool=new cc.NodePool,this.gameReady.active=!0,this.gamePlay.active=!1,this.gameOver.active=!1,this.numItem=3,this.gameType=0,this.setTouch()},logArray:function(){for(var t=this.array.length-1;t>=0;t--)cc.log(this.array[t])},init:function(){this.getUserInfo(),this.arr_gameType=new Array,this.arr_gameType.push(this.userData.game_3),this.arr_gameType.push(this.userData.game_4),this.arr_gameType.push(this.userData.game_5),this.arr_gameType.push(this.userData.game_6),this.jiange=5,this.itemWH=Math.round(650/this.numItem),this.itemParentWh=this.itemWH*this.numItem+this.jiange*(this.numItem+1),this.itemParent.width=this.itemParentWh,this.itemParent.height=this.itemParentWh,this.addItemBg(),this.lab_num.string=this.arr_gameType[this.numItem-3].title,this.lab_score.string=this.arr_gameType[this.numItem-3].score,this.lab_bestScore.string=this.arr_gameType[this.numItem-3].bestScore;var t=this.arr_gameType[this.numItem-3].arr_histroy.length-1;if(t<=0&&(t=0),t>this.arr_gameType[this.numItem-3].backNum&&(t=this.arr_gameType[this.numItem-3].backNum),this.lab_arrHistroy.string="\u64a4\u56de("+t+")",0==this.arr_gameType[this.numItem-3].array.length)this.initArray(),this.addRandomArr();else{this.array=this.arr_gameType[this.numItem-3].array;for(var r=0;r<this.array.length;r++)for(var a=0;a<this.array[r].length;a++)if(this.array[r][a]>0){var e=cc.v2(r,a);this.createItem(e,this.array[r][a])}}},getUserInfo:function(){this.userData=JSON.parse(cc.sys.localStorage.getItem("userData_1")),null==this.userData&&(this.userData={game_3:{title:"3x3",score:0,bestScore:0,array:[],arr_histroy:[],backNum:3},game_4:{title:"4x4",score:0,bestScore:0,array:[],arr_histroy:[],backNum:3},game_5:{title:"5x5",score:0,bestScore:0,array:[],arr_histroy:[],backNum:3},game_6:{title:"6x6",score:0,bestScore:0,array:[],arr_histroy:[],backNum:3}})},saveUserInfo:function(){cc.sys.localStorage.setItem("userData_1",JSON.stringify(this.userData))},setScore:function(t){this.arr_gameType[this.numItem-3].score=this.arr_gameType[this.numItem-3].score+t,this.lab_score.string=this.arr_gameType[this.numItem-3].score,this.arr_gameType[this.numItem-3].bestScore<this.arr_gameType[this.numItem-3].score&&(this.arr_gameType[this.numItem-3].bestScore=this.arr_gameType[this.numItem-3].score,this.lab_bestScore.string=this.arr_gameType[this.numItem-3].bestScore),this.saveUserInfo()},initArray:function(){this.array=new Array;for(var t=0;t<this.numItem;t++)this.array[t]=new Array;for(var r=0;r<this.numItem;r++)for(var a=0;a<this.numItem;a++)this.array[r][a]=0},addRandomArr:function(){for(var t=[],r=0;r<this.array.length;r++)for(var a=0;a<this.array[r].length;a++)0==this.array[r][a]&&t.push(cc.v2(r,a));if(0!=t.length){var e=Math.floor(Math.random()*t.length),i=t[e].x,s=t[e].y,h=10*Math.random();this.array[i][s]=h<2?4:2,this.createItem(t[e],this.array[i][s],!0),this.pdGameOver()}var n=this.itemParent.children;cc.log("itemParent\u7684\u5b50\u8282\u70b9\u4e2a\u6570\uff1a"+n.length),this.logArray()},pdGameOver:function(){for(var t=!0,r=0;r<this.array.length;r++)for(var a=0;a<this.array[r].length;a++)0==this.array[r][a]&&(t=!1);for(var e=0;e<this.array.length;e++)for(var i=0;i<this.array[e].length;i++)i+1<this.array.length&&this.array[e][i]==this.array[e][i+1]?t=!1:e+1<this.array.length&&this.array[e][i]==this.array[e+1][i]&&(t=!1);if(t)this.gameType=2,this.scoreNumOver=this.arr_gameType[this.numItem-3].score,this.scheduleOnce(function(){this.lab_scoreOver.string="\u60a8\u5f97\u5230\u4e86"+this.scoreNumOver+"\u5206",this.gameOver.active=!0},1.5),this.arr_gameType[this.numItem-3].array=[],this.arr_gameType[this.numItem-3].score=0,this.arr_gameType[this.numItem-3].arr_histroy=[],this.saveUserInfo(),cc.log("\u6e38\u620f\u7ed3\u675f");else{this.arr_gameType[this.numItem-3].arr_histroy.push(this.array.join()),this.arr_gameType[this.numItem-3].array=this.array;var s=this.arr_gameType[this.numItem-3].arr_histroy.length-1;s>10&&this.arr_gameType[this.numItem-3].arr_histroy.shift(),s>this.arr_gameType[this.numItem-3].backNum&&(s=this.arr_gameType[this.numItem-3].backNum),this.lab_arrHistroy.string="\u64a4\u56de("+s+")",this.saveUserInfo()}},setTouch:function(){this.node.on("touchstart",function(t){1==this.gameType&&(this.pos_start=t.getLocation(),cc.log("touchstart:"+this.pos_start))},this),this.node.on("touchmove",function(t){this.gameType},this),this.node.on("touchend",function(t){if(1==this.gameType){this.pos_end=t.getLocation();var r=this.pos_end.x-this.pos_start.x,a=this.pos_end.y-this.pos_start.y;Math.abs(r)<10&&Math.abs(a)<10||(Math.abs(r)>Math.abs(a)?r>0?(this.moveItem("you"),cc.log("\u53f3\u79fb\u52a8")):(this.moveItem("zuo"),cc.log("\u5de6\u79fb\u52a8")):a>0?(this.moveItem("shang"),cc.log("\u4e0a\u79fb\u52a8")):(this.moveItem("xia"),cc.log("\u4e0b\u79fb\u52a8")),cc.log("touchend:"+this.pos_end))}},this)},addItemBg:function(){for(var t=cc.v2(-this.itemParent.width/2+this.itemWH/2+this.jiange,-this.itemParent.height/2+this.itemWH/2+this.jiange),r=0;r<this.numItem;r++)for(var a=0;a<this.numItem;a++){var e=cc.instantiate(this.pre_itemBg);e.parent=this.itemParent,e.width=this.itemWH,e.height=this.itemWH,e.x=t.x+(e.width+this.jiange)*a,e.y=t.y+(e.height+this.jiange)*r}},createItem:function(t,r,a){var e=cc.v2(-this.itemParent.width/2+this.itemWH/2+this.jiange,-this.itemParent.height/2+this.itemWH/2+this.jiange),i=null,s=(i=this.itemPool.size()>0?this.itemPool.get():cc.instantiate(this.pre_item)).getComponent("item");if(s&&s.init(r,this.numItem),i.parent=this.itemParent,i.width=this.itemWH,i.height=this.itemWH,i.x=e.x+(i.width+this.jiange)*t.y,i.y=e.y+(i.height+this.jiange)*t.x,a){i.scale=0;var h=cc.scaleTo(.15,1);i.runAction(h)}},onItemKilled:function(t){this.itemPool.put(t)},clickBtn:function(t,r){if(cc.log("\u70b9\u51fb\u4e86\u6309\u94ae"+r),"home_play"==r){if(2==this.gameType)return;this.gameType=0,this.cleanAllItem(),this.cleanAllItemBg(),this.gameReady.active=!0,this.gamePlay.active=!1,this.gameOver.active=!1}else if("home_over"==r)this.gameType=0,this.cleanAllItem(),this.cleanAllItemBg(),this.gameReady.active=!0,this.gamePlay.active=!1,this.gameOver.active=!1;else if("3"==r||"4"==r||"5"==r||"6"==r)this.gameType=1,this.numItem=parseInt(r),this.gameReady.active=!1,this.gamePlay.active=!0,this.init();else if("replay_play"==r){if(2==this.gameType)return;this.arr_gameType[this.numItem-3].score=0,this.arr_gameType[this.numItem-3].arr_histroy=[],this.lab_arrHistroy.string="\u64a4\u56de(0)",this.arr_gameType[this.numItem-3].backNum=3,this.setScore(0),this.cleanAllItem(),this.initArray(),this.addRandomArr()}else if("replay_over"==r)this.gameType=1,this.arr_gameType[this.numItem-3].score=0,this.arr_gameType[this.numItem-3].arr_histroy=[],this.lab_arrHistroy.string="\u64a4\u56de(0)",this.arr_gameType[this.numItem-3].backNum=3,this.setScore(0),this.gameOver.active=!1,this.cleanAllItem(),this.initArray(),this.addRandomArr();else if("back"==r){if((a=this.arr_gameType[this.numItem-3].arr_histroy.length)>=2&&this.arr_gameType[this.numItem-3].backNum>0){this.arr_gameType[this.numItem-3].arr_histroy.pop();var a,e=this.arr_gameType[this.numItem-3].arr_histroy[a-2].split(",");this.cleanAllItem();for(var i=-1,s=0;s<this.array.length;s++)for(var h=0;h<this.array[s].length;h++)if(i++,this.array[s][h]=parseInt(e[i]),this.array[s][h]>0){var n=cc.v2(s,h);this.createItem(n,this.array[s][h])}this.arr_gameType[this.numItem-3].backNum--,(a=this.arr_gameType[this.numItem-3].arr_histroy.length-1)<=0&&(a=0),a>this.arr_gameType[this.numItem-3].backNum&&(a=this.arr_gameType[this.numItem-3].backNum),this.lab_arrHistroy.string="\u64a4\u56de("+a+")",this.saveUserInfo()}}},cleanAllItem:function(){for(var t=this.itemParent.children,r=t.length-1;r>=0;r--){t[r].getComponent("item")&&this.onItemKilled(t[r])}},cleanAllItemBg:function(){for(var t=this.itemParent.children,r=t.length-1;r>=0;r--){t[r].getComponent("item")||this.itemParent.removeChild(t[r])}},update:function(t){},moveItem:function(t){var r=!1,a=!1;switch(t){case"shang":for(var e=this.array.length-2;e>=0;e--)for(var i=0;i<this.array[e].length;i++)for(var s=0;s<this.array.length-1;s++)e+1+s<this.array.length&&0==this.array[e+1+s][i]&&this.array[e+s][i]>0?(this.array[e+1+s][i]=this.array[e+s][i],this.array[e+s][i]=0,r=!0):e+1+s<this.array.length&&this.array[e+1+s][i]==this.array[e+s][i]&&this.array[e+s][i]>0&&(this.array[e+1+s][i]=-2*this.array[e+1+s][i],this.array[e+s][i]=0,r=!0,this.setScore(Math.abs(this.array[e+1+s][i])),a=!0);break;case"xia":for(var h=1;h<this.array.length;h++)for(var n=0;n<this.array[h].length;n++)for(var o=0;o<this.array.length;o++)h-1-o>=0&&0==this.array[h-1-o][n]&&this.array[h-o][n]>0?(this.array[h-1-o][n]=this.array[h-o][n],this.array[h-o][n]=0,r=!0):h-1-o>=0&&this.array[h-1-o][n]==this.array[h-o][n]&&this.array[h-o][n]>0&&(this.array[h-1-o][n]=-2*this.array[h-1-o][n],this.array[h-o][n]=0,r=!0,this.setScore(Math.abs(this.array[h-1-o][n])),a=!0);break;case"you":for(var m=this.array.length-2;m>=0;m--)for(var c=0;c<this.array.length;c++)for(var y=0;y<this.array.length;y++)m+1+y<this.array.length&&0==this.array[c][m+1+y]&&this.array[c][m+y]>0?(this.array[c][m+1+y]=this.array[c][m+y],this.array[c][m+y]=0,r=!0):m+1+y<this.array.length&&this.array[c][m+1+y]==this.array[c][m+y]&&this.array[c][m+y]>0&&(this.array[c][m+1+y]=-2*this.array[c][m+1+y],this.array[c][m+y]=0,r=!0,this.setScore(Math.abs(this.array[c][m+1+y])),a=!0);break;case"zuo":for(var l=1;l<this.array.length;l++)for(var g=0;g<this.array[l].length;g++)for(var u=0;u<this.array.length;u++)l-1-u>=0&&0==this.array[g][l-1-u]&&this.array[g][l-u]>0?(this.array[g][l-1-u]=this.array[g][l-u],this.array[g][l-u]=0,r=!0):l-1-u>=0&&this.array[g][l-1-u]==this.array[g][l-u]&&this.array[g][l-u]>0&&(this.array[g][l-1-u]=-2*this.array[g][l-1-u],this.array[g][l-u]=0,r=!0,this.setScore(Math.abs(this.array[g][l-1-u])),a=!0)}if(r){a?cc.audioEngine.play(this.sound_getScore,!1,1):cc.audioEngine.play(this.sound_move,!1,1);for(var p=0;p<this.array.length;p++)for(var _=0;_<this.array[p].length;_++)this.array[p][_]<0&&(this.array[p][_]=Math.abs(this.array[p][_]));this.cleanAllItem();for(var f=0;f<this.array.length;f++)for(var v=0;v<this.array[f].length;v++)if(this.array[f][v]>0){var d=cc.v2(f,v);this.createItem(d,this.array[f][v])}this.addRandomArr()}}}),cc._RF.pop()},{}],gg:[function(t,r,a){"use strict";cc._RF.push(r,"aab10a1tSVHbZxpF+yiDdIy","gg"),cc.Class({extends:cc.Component,properties:{lab_num:cc.Label},onLoad:function(){this.numTime=5,this.lab_num.string=this.numTime,this.schedule(function(){this.numTime--,this.lab_num.string=this.numTime,0==this.numTime&&cc.director.loadScene("game")},1)},clickBtn:function(){cc.director.loadScene("game")}}),cc._RF.pop()},{}],item:[function(t,r,a){"use strict";cc._RF.push(r,"98f5ae4qKNG2KrwrpYJPnLa","item"),cc.Class({extends:cc.Component,properties:{lab_num:cc.Label},onLoad:function(){this.num=2},init:function(t,r){this.num=t,this.lab_num.string=t,this.setColor(t),3==r?this.lab_num.fontSize=70:4==r?this.lab_num.fontSize=65:5==r?this.lab_num.fontSize=55:6==r&&(this.lab_num.fontSize=45)},setColor:function(t){switch(t){case Math.pow(2,1):this.node.color=new cc.Color(238,228,218);break;case Math.pow(2,2):this.node.color=new cc.Color(237,224,200);break;case Math.pow(2,3):this.node.color=new cc.Color(242,177,121);break;case Math.pow(2,4):this.node.color=new cc.Color(245,149,99);break;case Math.pow(2,5):this.node.color=new cc.Color(246,124,95);break;case Math.pow(2,6):this.node.color=new cc.Color(246,94,59);break;case Math.pow(2,7):this.node.color=new cc.Color(237,206,115);break;case Math.pow(2,8):this.node.color=new cc.Color(236,201,97);break;case Math.pow(2,9):this.node.color=new cc.Color(238,199,80);break;case Math.pow(2,10):this.node.color=new cc.Color(239,196,65);break;case Math.pow(2,11):this.node.color=new cc.Color(239,193,46);break;case Math.pow(2,12):this.node.color=new cc.Color(255,60,61);break;case Math.pow(2,13):default:this.node.color=new cc.Color(255,30,32)}}}),cc._RF.pop()},{}]},{},["game","gg","item"]);